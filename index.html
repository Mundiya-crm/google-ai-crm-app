<script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.10.0",
    "react-dom/": "https://esm.sh/react-dom@^18.2.0/",
    "react/": "https://esm.sh/react@^18.2.0/",
    "react": "https://esm.sh/react@^18.2.0",
    "exceljs": "https://esm.sh/exceljs@^4.4.0",
    "jszip": "https://esm.sh/jszip@^3.10.1",
    "papaparse": "https://esm.sh/papaparse@^5.5.3",
    "buffer": "https://esm.sh/buffer@^6.0.3",
    "file-saver": "https://esm.sh/file-saver@^2.0.5"
  }
}
</script>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mundiya CRM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Helper function to apply opacity to CSS variables, replicating tailwind.config.js functionality
      function withOpacity(variableName) {
        return ({ opacityValue }) => {
          if (opacityValue !== undefined) {
            return `rgba(var(${variableName}), ${opacityValue})`;
          }
          return `rgb(var(${variableName}))`;
        };
      }

      // Replicating tailwind.config.js for the CDN build
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: withOpacity('--color-bg-primary'),
              secondary: withOpacity('--color-bg-secondary'),
              tertiary: withOpacity('--color-bg-tertiary'),
              header: withOpacity('--color-bg-header'),
              'content-primary': withOpacity('--color-content-bg-primary'),
              'content-secondary': withOpacity('--color-content-bg-secondary'),
              'content-tertiary': withOpacity('--color-content-bg-tertiary'),
              'content-header': withOpacity('--color-content-bg-header'),
              accent: {
                DEFAULT: withOpacity('--color-bg-accent'),
                hover: withOpacity('--color-bg-accent-hover'),
                text: withOpacity('--color-text-accent'),
              }
            },
            textColor: {
              primary: withOpacity('--color-text-primary'),
              secondary: withOpacity('--color-text-secondary'),
              'content-primary': withOpacity('--color-content-text-primary'),
              'content-secondary': withOpacity('--color-content-text-secondary'),
              accent: withOpacity('--color-text-accent'),
              inverted: withOpacity('--color-text-inverted'),
            },
            borderColor: {
              primary: withOpacity('--color-border-primary'),
              secondary: withOpacity('--color-border-secondary'),
              'content-primary': withOpacity('--color-content-border-primary'),
              'content-secondary': withOpacity('--color-content-border-secondary'),
              accent: withOpacity('--color-border-accent'),
            },
            ringColor: {
               accent: withOpacity('--color-border-accent'),
            },
            borderRadius: {
              'btn': 'var(--btn-radius)',
            },
            height: {
              'header': 'var(--header-height)',
            },
            padding: {
              'header': 'var(--header-height)',
            }
          },
        },
      }
    </script>
    <style>
      /* Plain CSS definitions copied from styles/globals.css */
      :root {
        --header-height: 48px;
      }
      .theme-sleek-carbon {
        --body-bg: rgb(var(--color-bg-primary));
        --color-bg-primary: 23 31 42;
        --color-bg-secondary: 30 41 59;
        --color-bg-tertiary: 48 59 79;
        --color-bg-header: 15 23 42;
        --color-bg-accent: 37 99 235;
        --color-bg-accent-hover: 59 130 246;
        --color-text-primary: 226 232 240;
        --color-text-secondary: 148 163 184;
        --color-text-accent: 96 165 250;
        --color-text-inverted: 15 23 42;
        --color-border-primary: 51 65 85;
        --color-border-secondary: 71 85 105;
        --color-border-accent: 59 130 246;
        --color-btn-primary-bg: var(--color-bg-accent);
        --color-btn-primary-text: 255 255 255;
        --color-btn-primary-bg-image: none;
        --color-btn-secondary-bg: var(--color-bg-tertiary);
        --color-btn-secondary-text: var(--color-text-primary);
        --glass-button-bg-image: linear-gradient(to top, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.15));
        --glass-button-box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        --color-content-bg-primary: 243 244 246;
        --color-content-bg-secondary: 255 255 255;
        --color-content-bg-tertiary: 229 231 235;
        --color-content-bg-header: 255 255 255;
        --color-content-text-primary: 17 24 39;
        --color-content-text-secondary: 75 85 99;
        --color-content-border-primary: 209 213 219;
        --color-content-border-secondary: 229 231 235;
      }
      .theme-oceanic-blue {
        --body-bg: rgb(var(--color-bg-primary));
        --color-bg-primary: 12 28 45;
        --color-bg-secondary: 20 44 71;
        --color-bg-tertiary: 33 63 97;
        --color-bg-header: 8 19 31;
        --color-bg-accent: 0 178 194;
        --color-bg-accent-hover: 20 184 166;
        --color-text-primary: 207 222 237;
        --color-text-secondary: 139 161 184;
        --color-text-accent: 29 203 216;
        --color-text-inverted: 12 28 45;
        --color-border-primary: 41 79 119;
        --color-border-secondary: 56 102 149;
        --color-border-accent: 0 178 194;
        --color-btn-primary-bg: var(--color-bg-accent);
        --color-btn-primary-text: 255 255 255;
        --color-btn-primary-bg-image: none;
        --color-btn-secondary-bg: var(--color-bg-tertiary);
        --color-btn-secondary-text: var(--color-text-primary);
        --glass-button-bg-image: linear-gradient(to top, rgba(220, 230, 255, 0.05), rgba(220, 230, 255, 0.15));
        --glass-button-box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        --color-content-bg-primary: 243 244 246;
        --color-content-bg-secondary: 255 255 255;
        --color-content-bg-tertiary: 229 231 235;
        --color-content-bg-header: 255 255 255;
        --color-content-text-primary: 17 24 39;
        --color-content-text-secondary: 75 85 99;
        --color-content-border-primary: 209 213 219;
        --color-content-border-secondary: 229 231 235;
      }
      .theme-classic-light {
        --body-bg: rgb(var(--color-bg-primary));
        --color-bg-primary: 243 244 246;
        --color-bg-secondary: 255 255 255;
        --color-bg-tertiary: 229 231 235;
        --color-bg-header: 255 255 255;
        --color-bg-accent: 37 99 235;
        --color-bg-accent-hover: 59 130 246;
        --color-text-primary: 17 24 39;
        --color-text-secondary: 75 85 99;
        --color-text-accent: 29 78 216;
        --color-text-inverted: 255 255 255;
        --color-border-primary: 209 213 219;
        --color-border-secondary: 229 231 235;
        --color-border-accent: 59 130 246;
        --color-btn-primary-bg: var(--color-bg-accent);
        --color-btn-primary-text: 255 255 255;
        --color-btn-primary-bg-image: none;
        --color-btn-secondary-bg: var(--color-bg-tertiary);
        --color-btn-secondary-text: var(--color-text-primary);
        --glass-button-bg-image: linear-gradient(to top, rgba(0, 0, 0, 0.03), rgba(0, 0, 0, 0.06));
        --glass-button-box-shadow: 0 4px 20px rgba(17, 24, 39, 0.1);
        --color-content-bg-primary: 23 31 42;
        --color-content-bg-secondary: 30 41 59;
        --color-content-bg-tertiary: 48 59 79;
        --color-content-bg-header: 15 23 42;
        --color-content-text-primary: 226 232 240;
        --color-content-text-secondary: 148 163 184;
        --color-content-border-primary: 51 65 85;
        --color-content-border-secondary: 71 85 105;
      }
      .theme-windows-aero {
        --body-bg: linear-gradient(to bottom, #74bde8, #97d4f6);
        --color-bg-primary: 240 245 250;
        --color-bg-secondary: 255 255 255 / 0.6;
        --color-bg-tertiary: 235 245 255 / 0.7;
        --color-bg-header: 255 255 255 / 0.5;
        --color-bg-accent: 50 120 220;
        --color-bg-accent-hover: 80 150 240;
        --color-text-primary: 10 20 30;
        --color-text-secondary: 80 90 110;
        --color-text-accent: 50 120 220;
        --color-text-inverted: 255 255 255;
        --color-border-primary: 150 180 220 / 0.7;
        --color-border-secondary: 180 200 220;
        --color-border-accent: 50 120 220;
        --color-btn-primary-bg: transparent;
        --color-btn-primary-text: 255 255 255;
        --color-btn-primary-bg-image: linear-gradient(to bottom, rgb(100, 170, 240), rgb(50, 120, 220));
        --color-btn-secondary-bg: var(--color-bg-tertiary);
        --color-btn-secondary-text: var(--color-text-primary);
        --glass-button-bg-image: linear-gradient(to top, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.3));
        --glass-button-box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        --color-content-bg-primary: 23 31 42;
        --color-content-bg-secondary: 30 41 59;
        --color-content-bg-tertiary: 48 59 79;
        --color-content-bg-header: 15 23 42;
        --color-content-text-primary: 226 232 240;
        --color-content-text-secondary: 148 163 184;
        --color-content-border-primary: 51 65 85;
        --color-content-border-secondary: 71 85 105;
      }
      .theme-aero-noir {
        --body-bg: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
        --color-bg-primary: 15 20 30;
        --color-bg-secondary: 15 25 40 / 0.65;
        --color-bg-tertiary: 30 45 65 / 0.5;
        --color-bg-header: 15 25 40 / 0.5;
        --color-bg-accent: 0 191 255;
        --color-bg-accent-hover: 60 210 255;
        --color-text-primary: 230 240 255;
        --color-text-secondary: 150 170 200;
        --color-text-accent: 60 210 255;
        --color-text-inverted: 15 20 30;
        --color-border-primary: 80 150 220 / 0.5;
        --color-border-secondary: 50 80 120;
        --color-border-accent: 0 191 255;
        --color-btn-primary-bg: transparent;
        --color-btn-primary-text: 255 255 255;
        --color-btn-primary-bg-image: linear-gradient(to bottom, rgb(20, 150, 220), rgb(0, 120, 190));
        --color-btn-secondary-bg: var(--color-bg-tertiary);
        --color-btn-secondary-text: var(--color-text-primary);
        --glass-button-bg-image: linear-gradient(to top, rgba(80, 150, 220, 0.2), rgba(80, 150, 220, 0.1));
        --glass-button-box-shadow: 0 2px 15px rgba(0, 191, 255, 0.2);
        --color-content-bg-primary: 243 244 246;
        --color-content-bg-secondary: 255 255 255;
        --color-content-bg-tertiary: 229 231 235;
        --color-content-bg-header: 255 255 255;
        --color-content-text-primary: 17 24 39;
        --color-content-text-secondary: 75 85 99;
        --color-content-border-primary: 209 213 219;
        --color-content-border-secondary: 229 231 235;
      }
      .theme-minty-fresh {
        --body-bg: rgb(var(--color-bg-primary));
        --color-bg-primary: 240 255 245;
        --color-bg-secondary: 255 255 255;
        --color-bg-tertiary: 220 250 230;
        --color-bg-header: 255 255 255;
        --color-bg-accent: 16 185 129;
        --color-bg-accent-hover: 52 211 153;
        --color-text-primary: 20 50 40;
        --color-text-secondary: 50 90 70;
        --color-text-accent: 16 185 129;
        --color-text-inverted: 255 255 255;
        --color-border-primary: 180 220 200;
        --color-border-secondary: 220 250 230;
        --color-border-accent: 16 185 129;
        --color-btn-primary-bg: var(--color-bg-accent);
        --color-btn-primary-text: 255 255 255;
        --color-btn-primary-bg-image: none;
        --color-btn-secondary-bg: var(--color-bg-tertiary);
        --color-btn-secondary-text: var(--color-text-primary);
        --glass-button-bg-image: linear-gradient(to top, rgba(20, 50, 40, 0.03), rgba(20, 50, 40, 0.06));
        --glass-button-box-shadow: 0 4px 20px rgba(50, 90, 70, 0.15);
        --color-content-bg-primary: 23 31 42;
        --color-content-bg-secondary: 30 41 59;
        --color-content-bg-tertiary: 48 59 79;
        --color-content-bg-header: 15 23 42;
        --color-content-text-primary: 226 232 240;
        --color-content-text-secondary: 148 163 184;
        --color-content-border-primary: 51 65 85;
        --color-content-border-secondary: 71 85 105;
      }
      .theme-sakura-pink {
        --body-bg: rgb(var(--color-bg-primary));
        --color-bg-primary: 255 245 250;
        --color-bg-secondary: 255 255 255;
        --color-bg-tertiary: 254 226 226;
        --color-bg-header: 255 255 255;
        --color-bg-accent: 236 72 153;
        --color-bg-accent-hover: 244 114 182;
        --color-text-primary: 80 30 50;
        --color-text-secondary: 120 70 90;
        --color-text-accent: 236 72 153;
        --color-text-inverted: 255 255 255;
        --color-border-primary: 252 165 165;
        --color-border-secondary: 254 226 226;
        --color-border-accent: 236 72 153;
        --color-btn-primary-bg: var(--color-bg-accent);
        --color-btn-primary-text: 255 255 255;
        --color-btn-primary-bg-image: none;
        --color-btn-secondary-bg: var(--color-bg-tertiary);
        --color-btn-secondary-text: var(--color-text-primary);
        --glass-button-bg-image: linear-gradient(to top, rgba(80, 30, 50, 0.03), rgba(80, 30, 50, 0.06));
        --glass-button-box-shadow: 0 4px 20px rgba(120, 70, 90, 0.15);
        --color-content-bg-primary: 23 31 42;
        --color-content-bg-secondary: 30 41 59;
        --color-content-bg-tertiary: 48 59 79;
        --color-content-bg-header: 15 23 42;
        --color-content-text-primary: 226 232 240;
        --color-content-text-secondary: 148 163 184;
        --color-content-border-primary: 51 65 85;
        --color-content-border-secondary: 71 85 105;
      }
      .theme-matrix-green {
        --body-bg: rgb(var(--color-bg-primary));
        --color-bg-primary: 5 10 5;
        --color-bg-secondary: 15 20 15;
        --color-bg-tertiary: 25 40 25;
        --color-bg-header: 0 0 0;
        --color-bg-accent: 34 197 94;
        --color-bg-accent-hover: 74 222 128;
        --color-text-primary: 50 255 50;
        --color-text-secondary: 50 200 50;
        --color-text-accent: 74 222 128;
        --color-text-inverted: 0 0 0;
        --color-border-primary: 20 60 20;
        --color-border-secondary: 15 40 15;
        --color-border-accent: 34 197 94;
        --color-btn-primary-bg: var(--color-bg-accent);
        --color-btn-primary-text: 0 0 0;
        --color-btn-primary-bg-image: none;
        --color-btn-secondary-bg: var(--color-bg-tertiary);
        --color-btn-secondary-text: var(--color-text-primary);
        --glass-button-bg-image: linear-gradient(to top, rgba(50, 255, 50, 0.05), rgba(50, 255, 50, 0.10));
        --glass-button-box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        --color-content-bg-primary: 243 244 246;
        --color-content-bg-secondary: 255 255 255;
        --color-content-bg-tertiary: 229 231 235;
        --color-content-bg-header: 255 255 255;
        --color-content-text-primary: 17 24 39;
        --color-content-text-secondary: 75 85 99;
        --color-content-border-primary: 209 213 219;
        --color-content-border-secondary: 229 231 235;
      }
      .theme-sunset-glow {
        --body-bg: rgb(var(--color-bg-primary));
        --color-bg-primary: 25 20 40;
        --color-bg-secondary: 40 30 60;
        --color-bg-tertiary: 60 50 85;
        --color-bg-header: 20 15 30;
        --color-bg-accent: 249 115 22;
        --color-bg-accent-hover: 251 146 60;
        --color-text-primary: 255 250 230;
        --color-text-secondary: 200 190 220;
        --color-text-accent: 251 146 60;
        --color-text-inverted: 25 20 40;
        --color-border-primary: 80 70 110;
        --color-border-secondary: 50 40 70;
        --color-border-accent: 249 115 22;
        --color-btn-primary-bg: var(--color-bg-accent);
        --color-btn-primary-text: 255 255 255;
        --color-btn-primary-bg-image: none;
        --color-btn-secondary-bg: var(--color-bg-tertiary);
        --color-btn-secondary-text: var(--color-text-primary);
        --glass-button-bg-image: linear-gradient(to top, rgba(255, 250, 230, 0.05), rgba(255, 250, 230, 0.10));
        --glass-button-box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        --color-content-bg-primary: 243 244 246;
        --color-content-bg-secondary: 255 255 255;
        --color-content-bg-tertiary: 229 231 235;
        --color-content-bg-header: 255 255 255;
        --color-content-text-primary: 17 24 39;
        --color-content-text-secondary: 75 85 99;
        --color-content-border-primary: 209 213 219;
        --color-content-border-secondary: 229 231 235;
      }
      .buttons-sharp { --btn-radius: 0.125rem; }
      .buttons-rounded { --btn-radius: 0.5rem; }
      body {
        background: var(--body-bg);
        background-color: rgb(var(--color-bg-primary));
        background-attachment: fixed;
        color: rgb(var(--color-text-primary));
        height: 100vh;
        overflow: hidden;
      }
      ::-webkit-scrollbar { width: 16px; height: 16px; }
      ::-webkit-scrollbar-track { background: rgb(var(--color-bg-secondary)); }
      ::-webkit-scrollbar-thumb { background-color: rgb(var(--color-bg-accent)); border-radius: 8px; border: 3px solid rgb(var(--color-bg-secondary)); }
      ::-webkit-scrollbar-thumb:hover { background-color: rgb(var(--color-bg-accent-hover)); }
      @media print {
        body, html { background: white !important; color: black !important; }
        .no-print { display: none !important; }
        main#printable-area { padding: 0 !important; overflow: visible !important; height: auto !important; max-height: none !important; }
        .printable-document-container { padding: 0; }
        .printable-document { width: 100% !important; height: auto !important; min-height: 0 !important; border: none !important; box-shadow: none !important; margin: 0 !important; padding: 0 !important; background: white !important; color: black !important; border-radius: 0 !important; display: block !important; font-size: 10pt; }
        .printable-document-container h1 { font-size: 18pt; }
        .printable-document-container h2 { font-size: 14pt; }
        @page { size: A4; margin: 1.5cm; }
      }
      .dropdown-container:hover .dropdown-menu {
        display: block;
      }
    </style>
    <style type="text/tailwindcss">
      @layer base {
        option {
          background-color: rgb(var(--color-bg-secondary));
          color: rgb(var(--color-text-primary));
        }
        @keyframes highlight-glow {
          0% { background-color: rgba(var(--color-bg-accent), 0.3); box-shadow: 0 0 15px rgba(var(--color-bg-accent), 0.5); }
          100% { background-color: rgba(var(--color-bg-accent), 0.05); box-shadow: 0 0 0 rgba(var(--color-bg-accent), 0); }
        }
        @keyframes fade-in {
          from { opacity: 0; transform: translateY(-10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        @keyframes badge-pop-in {
          0% { transform: scale(0.5); opacity: 0; }
          80% { transform: scale(1.1); opacity: 1; }
          100% { transform: scale(1); opacity: 1; }
        }
      }
      @layer components {
          .btn { @apply px-4 py-2 text-sm font-bold transition-colors shadow-sm; border-radius: var(--btn-radius); }
          .btn-primary { @apply btn; background-color: rgb(var(--color-btn-primary-bg)); background-image: var(--color-btn-primary-bg-image, none); color: rgb(var(--color-btn-primary-text)); border: 1px solid rgba(var(--color-border-accent), 0.5); }
          .btn-primary:hover { background-color: rgb(var(--color-bg-accent-hover)); filter: brightness(1.1); }
          .btn-primary:disabled { background-color: rgb(var(--color-bg-tertiary)); background-image: none; color: rgb(var(--color-text-secondary)); cursor: not-allowed; opacity: 0.6; filter: none; }
          .glass-button { @apply flex items-center justify-center p-3 flex-col h-full text-center; background-color: rgba(var(--color-content-bg-tertiary), 0.5); border: 1px solid rgba(var(--color-content-border-primary), 0.3); border-radius: var(--btn-radius); box-shadow: 0 4px 20px rgba(0,0,0, 0.1); -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px); transition: all 0.2s ease-in-out; }
          .glass-button:hover { background-color: rgba(var(--color-bg-accent), 0.15); border-color: rgba(var(--color-border-accent), 0.5); transform: translateY(-2px); box-shadow: 0 6px 25px rgba(var(--color-bg-accent), 0.2); }
          .glass-button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; border-color: rgba(var(--color-content-border-primary), 0.3); background-color: rgba(var(--color-content-bg-tertiary), 0.5); box-shadow: 0 4px 20px rgba(0,0,0, 0.1); }
          .ai-populated-highlight { animation: highlight-glow 2s ease-out forwards; }
          .animate-fade-in { animation: fade-in 0.5s ease-out forwards; }
          .animate-badge-pop-in { animation: badge-pop-in 0.3s ease-out forwards; }
          .btn-secondary { @apply btn bg-tertiary text-primary hover:bg-tertiary/70 border border-primary/50; }
      }
    </style>
</head>
<body class="theme-sleek-carbon buttons-rounded">
    <div id="root"></div>
    <script type="module" src="/src/index.tsx"></script>
</body>
</html>